function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _construct(t,e,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var a=new(Function.bind.apply(t,o));return n&&_setPrototypeOf(a,n.prototype),a}).apply(null,arguments)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}var WovaxIdxReactMap=function(n){"use strict";function t(t){var e;return(e=n.call(this,t)||this).mapRef=React.createRef(),e.map=null,e}_inheritsLoose(t,n);var e=t.prototype;return e.addMap=function(){this.map=document.createElement("div"),this.map.style.width="100%",this.map.style.height=this.props.height+"px",this.map.style.marginTop="1em",this.map.style.marginBottom="1em",this.map.style.zIndex=0,this.map.innerHTML="Loading Map...",this.mapRef.current.appendChild(this.map);var t=null;switch(this.props.type){case"google":t=WovaxIdxGoogleMap;break;case"location_iq":t=WovaxIdxLocationIqMap;break;case"map_quest":t=WovaxIdxMapQuest;break;default:return}var e=this.props,n=new t(this.map,e.token,e.lat,e.long);e.onMountGetMap(n)},e.componentDidMount=function(){this.mapPropsGood()&&this.addMap()},e.componentDidUpdate=function(t){var e=this.props;null!==this.map&&t.height!==e.height&&(this.map.style.height=e.height+"px"),t.type!==e.type&&(null!==this.map&&this.map.remove(),this.mapPropsGood()&&this.addMap())},e.noDisplay=function(t){var e={height:this.props.height+"px",width:"100%",backgroundColor:t.backGroundColor,display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center",textAlign:"center"},n="";this.isTokenSet()||(n=t.noTokenMsg),this.isTypeGood()||(n="Please select a provider for this block.");var o=null;return 0<n.length&&(o=React.createElement(wp.element.Fragment,null,React.createElement("br",null),React.createElement("h2",{style:{color:"#FFF"}},n))),React.createElement("div",null,React.createElement("div",{style:e},React.createElement("p",null,React.createElement("h3",{style:{color:"#FFF"}},t.title),o)),this.props.children)},e.render=function(){return this.mapPropsGood()?React.createElement("div",{ref:this.mapRef}):this.noDisplay(this.props)},e.mapPropsGood=function(){var t=this.isTypeGood();return t=t&&this.isTokenSet()},e.isTypeGood=function(){return!!["google","location_iq","map_quest"].includes(this.props.type)},e.isTokenSet=function(){return!(this.props.token.length<1)},t}(wp.element.Component);WovaxIdxReactMap.defaultProps={backGroundColor:"#6EE28A",height:"500px",lat:46.7323603,long:-117.0010062,noTokenMsg:"Set an API key on the Wovax IDX Initial Setup page.",onMountGetMap:function(){},title:"Listing Map",token:"",type:"none"};var WovaxIdxReactDropDown=function(n){"use strict";function t(t){var e;return(e=n.call(this,t)||this).ref=React.createRef(),e}return _inheritsLoose(t,n),t.prototype.render=function(){var e=this;return React.createElement(wp.element.Fragment,null,React.createElement("label",{style:{marginBottom:"6.5px"}},this.props.title),React.createElement("form",null,React.createElement("select",{ref:this.ref,value:this.props.value,style:{boxSizing:"border-box",marginBottom:"6.5px"},onChange:function(t){e.props.onChange(e.ref.current.value),t.preventDefault()}},React.createElement("option",{disabled:!0,selected:!0,value:"none"},this.props.selectMsg),this.props.options.map(function(t){return React.createElement("option",{value:t[0]},t[1])}))))},t}(wp.element.Component);WovaxIdxReactDropDown.defaultProps={options:[],selectMsg:"Select an Option",title:"",value:"none",onChange:function(t){}};var WovaxIdxMapStore=function(){"use strict";function t(){this.map=null,this.markers=[]}var e=t.prototype;return e.setMap=function(t){this.map=t,(new WovaxIdxMapLoader).registerMap(t);for(var e=this.markers,n=0;n<e.length;n++)e[n].triggerUnbind(),t.addMarker(e[n])},e.addMarker=function(t){null!==this.map&&this.map.addMarker(t),this.markers.push(t)},e.getMarkers=function(t){if("string"!=typeof t)return this.markers;for(var e=[],n=0;n<this.markers.length;n++){var o=this.markers[n];o.getType()===t&&e.push(o)}return e},e.removeMarkerType=function(e){if("string"==typeof e){var n=[];this.markers.map(function(t){t.getType()===e?t.triggerUnbind():n.push(t)}),this.markers=n}},t}(),WovaxIdxPoiBlock=function(n){"use strict";function t(t){var e;return(e=n.call(this,t)||this).mapStore=new WovaxIdxMapStore,e}_inheritsLoose(t,n);var e=t.prototype;return e.loadMarkerType=function(n){var t=this.props,e=t.api,o=t.pos,a=1609.344*t.radius,i=this.mapStore,r="";"function"==typeof e.getPlaces&&(t.pinColors.hasOwnProperty(n)&&(r=t.pinColors[n]),e.getPlaces.apply(e,[n].concat(o,[a,function(t){i.removeMarkerType(n),t.map(function(t){var e=new WovaxIdxMarker(t.lat,t.lon,r,n);t.hasOwnProperty("name")&&e.setPopup(t.name,""),i.addMarker(e)})}])))},e.initMarkers=function(){var e=this,t=this.props,n=t.pinColors,o=t.places;this.mapStore.removeMarkerType(""),this.mapStore.addMarker(_construct(WovaxIdxMarker,t.pos.concat([n.__listing]))),o.map(function(t){e.loadMarkerType(t)})},e.componentDidUpdate=function(n){var o=this.props,a=this.mapStore;Object.keys(o.pinColors).map(function(t){if(!n.pinColors.hasOwnProperty(t)||n.pinColors[t]!==o.pinColors[t]){var e=o.pinColors[t];"__listing"===t&&(t=""),a.getMarkers(t).map(function(t){t.setColor(e)})}}),n.places.filter(function(t){return!o.places.includes(t)}).map(function(t){a.removeMarkerType(t)});var e=this;o.places.filter(function(t){return!n.places.includes(t)}).map(function(t){e.loadMarkerType(t)}),Number(n.radius)!==Number(o.radius)&&this.initMarkers()},e.render=function(){var t=[["__listing","Listing Pin"],["airport","Airports"],["atm","ATMs"],["bank","Banks"],["bus_station","Bus Stations"],["cinema","Movie Theatres"],["college","Colleges"],["fuel","Gas Stations"],["gym","Gyms"],["hospital","Hospitals"],["hotel","Hotels"],["park","Parks"],["pharmacy","Pharmacies"],["pub","Bars/Pubs"],["railway_station","Rail Stations"],["restaurant","Restaurants"],["school","Schools"],["stadium","Stadiums"],["supermarket","Supermarkets"]],e=this,a=this.props,n=this.mapStore,i=a.pinColors,r=wp.components,o=wp.blockEditor,s=wp.element;return React.createElement(s.Fragment,null,React.createElement(o.InspectorControls,null,React.createElement(r.PanelBody,{title:"Map Settings"},React.createElement(r.RangeControl,{label:"Height",initialPosition:500,min:250,max:1500,value:a.height,onChange:function(t){a.onChangeHeight(t)}}),React.createElement(r.TextControl,{label:"Search Radius in Miles (Max 18.5)",value:a.radius,onChange:function(t){var e=new RegExp("^[0-9]*[.]?[0-9]*$");(t=t.replace(new RegExp("^0+"),"")).length<1&&(t="0"),"."===t.charAt(0)&&(t="0"+t),e.test(t)&&(18.5<t||a.onChangeRadius(t))}})),React.createElement(r.PanelBody,{title:"Choose Places",initialOpen:!1},t.map(function(o){return"__listing"===o[0]?null:React.createElement(r.CheckboxControl,{label:o[1],checked:a.places.includes(o[0]),onChange:function(){var t=o[0],e=a.places.slice(),n=e.indexOf(t);-1<n?e.splice(n,1):e.push(t),a.onChangePlaces(e)}})})),React.createElement(o.PanelColorSettings,{title:"Pin Colors",initialOpen:!1,colorSettings:[].concat(t.filter(function(t){return"__listing"===t[0]||a.places.includes(t[0])}).map(function(o){return{label:o[1],value:i.hasOwnProperty(o[0])?i[o[0]]:"",onChange:function(t){"string"!=typeof t&&(t="");var e=Object.keys(i),n={};e.map(function(t){n[t]=i[t]}),n[o[0]]=t,a.onChangePinColors(n)}}}))})),React.createElement(WovaxIdxReactMap,{title:"Points of Interest",height:a.height,token:WovaxBlockData.mapTokens.location_iq,lat:a.pos[0],long:a.pos[1],type:"location_iq",noTokenMsg:"Set a Location IQ key on the Wovax IDX Initial Setup page.",onMountGetMap:function(t){n.setMap(t),e.initMarkers()}}))},t}(wp.element.Component);function wovax_idx_add_poi_block(){var t,n=[37.773972,-122.431297],o=new WovaxIdxLocationIqPOI(WovaxBlockData.mapTokens.location_iq),e=((t={title:"Points of Interest",icon:WovaxBlockData.icons.poi,description:"Displays various points of interest near the property such as restaurants, and schools ect..."}).icon=WovaxBlockData.icons.poi,t.category="wovax-idx",t.attributes={height:{type:"number",default:500},searchRadiusMiles:{type:"string",default:1.5},pinColors:{type:"object",default:{__listing:"",college:"",school:""}},places:{type:"array",default:["college","school"]}},t.save=function(){return null},t);e.edit=function(e){e.attributes.height,e.attributes.listingPinColor,e.attributes.searchRadiusMiles,e.attributes.tagColors;return React.createElement(WovaxIdxPoiBlock,{api:o,pos:n,height:e.attributes.height,pinColors:e.attributes.pinColors,places:e.attributes.places,radius:e.attributes.searchRadiusMiles,onChangeHeight:function(t){e.setAttributes({height:t})},onChangePinColors:function(t){e.setAttributes({pinColors:t})},onChangePlaces:function(t){e.setAttributes({places:t})},onChangeRadius:function(t){e.setAttributes({searchRadiusMiles:t})}})},wp.blocks.registerBlockType("wovax-idx-wordpress/points-of-interest",e)}WovaxIdxPoiBlock.defaultProps={api:null,height:500,pinColors:{__listing:""},pos:[46.7323603,-117.0010062],places:["college","school"],radius:1.5,onChangeHeight:function(t){},onChangePinColors:function(t){},onChangePlaces:function(t){},onChangeRadius:function(t){}},wovax_idx_add_poi_block();var WovaxIdxMapBlock=function(n){"use strict";function t(t){var e;return(e=n.call(this,t)||this).mapStore=new WovaxIdxMapStore,e}_inheritsLoose(t,n);var e=t.prototype;return e.componentDidUpdate=function(t){if(t.pinColor!==this.props.pinColor){var e=this.props.pinColor;this.mapStore.getMarkers("").map(function(t){t.setColor(e)})}},e.render=function(){var t=wp.components,e=wp.blockEditor,n=wp.element,o=[46.7323603,-117.0010062],a=this.props.height,i=this.props.type,r=this.props.pinColor,s=this.mapStore,p=this;return React.createElement(n.Fragment,null,React.createElement(e.InspectorControls,null,React.createElement(t.PanelBody,{title:"Map Settings"},React.createElement(WovaxIdxReactDropDown,{title:"Provider",selectMsg:" -- select a map provider -- ",value:i,onChange:function(t){p.props.onChangeType(t)},options:[["google","Google Maps"],["location_iq","Location IQ"],["map_quest","MapQuest"]]}),React.createElement(t.RangeControl,{label:"Height",initialPosition:500,min:250,max:1500,value:a,onChange:function(t){p.props.onChangeHeight(t)}})),React.createElement(e.PanelColorSettings,{title:"Pin Colors",initialOpen:!1,colorSettings:[{label:"Listing Pin",value:r,onChange:function(t){p.props.onChangePinColor(t)}}]})),React.createElement(WovaxIdxReactMap,{height:a,token:WovaxBlockData.mapTokens[i],lat:o[0],long:o[1],type:i,onMountGetMap:function(t){s.removeMarkerType(""),s.setMap(t),s.addMarker(_construct(WovaxIdxMarker,o.concat([r])))}}))},t}(wp.element.Component);WovaxIdxMapBlock.defaultProps={height:500,pinColor:"",type:"none",onChangeHeight:function(t){},onChangePinColor:function(t){},onChangeType:function(t){}},wp.blocks.registerBlockType("wovax-idx-wordpress/listing-map",{title:"Listing Map",icon:WovaxBlockData.icons.map,description:"Show the listing on a map.",category:"wovax-idx",attributes:{height:{type:"number",default:500},mapType:{type:"string",default:"none"},listingPinColor:{type:"string",default:""}},save:function(){return null},edit:function(e){return React.createElement(WovaxIdxMapBlock,{height:e.attributes.height,pinColor:e.attributes.listingPinColor,type:e.attributes.mapType,token:WovaxBlockData.mapTokens[e.attributes.mapType],onChangeHeight:function(t){e.setAttributes({height:t})},onChangePinColor:function(t){e.setAttributes({listingPinColor:t})},onChangeType:function(t){e.setAttributes({mapType:t})}})}});